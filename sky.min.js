var e={};window.addEventListener("load",(()=>{setTimeout((()=>{a.go(n.screen)}),10)})),Game.intro={firstPage:()=>{r("\n        \n        There's a sound. It's not good. Your brain, still steeped in hyper-sleep chemicals, has come round to the point\n        where you're awake and something has gone woefully awry.\n\n        It's an alarm. An alarm is ringing from the engine.\n\n        The hyper-sleep containment unit swings open and your feet find the cold metal floor. The air of your ship is \n        thick with smoke.\n\n        "),s("Ugghh... It's too early for an emergency...",(()=>d(e.intro.secondPage)))},secondPage:()=>{r("\n        \n        Then another sound: this one is sudden and shakes the entire ship. You grasp a bulkhead and nearly slice your fingers on\n        the cheap titanium bolts holding your ship together. Another shake, like being inside dump truck that's currently\n        in the process of traversing to Mars with a catapult.\n\n        After that, everything is still. The alarm was still ringing. Your engineer, and the only member of your crew, Yates,\n        emerges into your still blurry vision.\n        \n        "),s("Yates! What happened?",(()=>d(e.intro.thirdPage)))},thirdPage:()=>{r('\n        \n        "Sorry, boss," said Yates with a noisy slurp. He was drinking something. Slowly it dawned on you; it was a ginormous can of raspberry soda pop,\n        festooned with a cherry-red flamingo straw.\n\n        "Not sure how it happened, but somebody got raspberry soda all over the engine core. Had to make an emergency landing till\n        we can fix this rig. Shouldn\'t be more than a couple of weeks.\n        \n        '),s("Did you say two weeks?",(()=>d(e.intro.thirdPage)))}},Game.myShip={cockpit:()=>{r("\n        \n            Your command chair is surrounded by an array of screens, lights and controls telling you every detail\n            of what's happening on your ship. Right now, they're all very upset for some reason. A distant alarm\n            echoes from the engine cavity. A sturdy metal ladder descends to the main deck.\n\n        "),s("Climb down to the Main Deck",(()=>d(e.myShip.mainDeck))),s("Sit in the chair",(()=>"You sit in the command chair and feel very heroic.")),s("Look out the window","Hmm. The purple sky and distant golden mountains don't resemble any planet you've visited before.")}};const n={screen:()=>{r("\n        \n            Title Screen\n\n        "),l("The cat waits",["foo","bar","foozle","muddle"]),s("Start",(()=>{e={...Game},console.log(e),d(e.intro.firstPage)})),s("About",(()=>a.go(n.about)))},about:()=>{r("\n\n            About this book\n\n        "),s("OK Then",(()=>d(n.screen))),s("About","Why Cat!!")}},t={backButtonHidden:!1,clear:()=>{document.getElementById("Buttons").innerHTML=""},add:(e,n)=>{const r=document.getElementById("Buttons");if(r){e=e.trim();const i=document.createElement("button");i.onclick=()=>{o.clear(),t.clear(),t.backButtonHidden=!1,"string"==typeof n?o.set(n):n(),t.backButtonHidden||t.add("Back",(()=>{a.go(a.lastCallback)})),t.backButtonHidden=!0},i.className="Choice",i.innerHTML=c(e),r.appendChild(i)}}},o={clear:()=>{document.getElementById("Output").innerHTML=""},add:e=>{const n=document.getElementById("Output");if(n){e=(e=c(e)).split("\n\n").filter((e=>""!==e.trim()));for(const t of e){const e=document.createElement("p");e.innerHTML=c(t),n.appendChild(e)}}},set:e=>{o.clear(),o.add(e)}},a={lastCallback:()=>{},go:e=>{t.backButtonHidden=!0,e(),a.lastCallback=e}},r=e=>o.add(e),s=(e,n)=>t.add(e,n),d=e=>a.go(e),l=(n,t)=>((n,t)=>{const o=`i${function(){var e=0;if(0==n.length)return e;for(i=0;i<n.length;i++)char=n.charCodeAt(i),e=(e<<5)-e+char,e&=e;return e}()}`;e[o]?Array.isArray(t)?h(t):r(t):(e[o]=!0,r(n))})(n,t),h=e=>(e=>{const n=function(e){let n,t=e.length;for(;0!=t;)n=Math.floor(Math.random()*t),t--,[e[t],e[n]]=[e[n],e[t]];return e}([...e]);r(n[0])})(e),c=e=>{const n={quote:!0,bold:!0,italic:!0},t=(t,o,a)=>{for(;e.indexOf(t)>-1;)e=n[o]?e.replace(t,`<${a}>`):e.replace(t,`</${a}>`),n[o]=!n[o]};return t('"',"quote","q"),t("**","bold","b"),t("*","italic","i"),e=e.trim()};